var Emot=function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,i(t,e,"get"))}function n(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,i(t,e,"set"),n),n}function i(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function a(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function o(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(t,e,n){o(t,e),e.set(t,n)}function s(t,e){o(t,e),e.add(t)}function c(t,e){var n=document.createElement(t);return e&&(n.className=e),n}function l(t){return 1===t.nodeType?t:document.querySelector(t)}var p=new WeakMap,h=new WeakMap,d=new WeakMap,u=new WeakSet,f=new WeakSet,m=new WeakSet,g=new WeakSet,v=new WeakSet;function x(){var t=this;for(var i in e(t,p).emotMaps){if("text"!==e(t,p).emotMaps[i].type){var o=e(t,p).emotMaps[i].items;n(t,d,Object.assign(e(t,d),o))}}a(t,f,b).call(t),e(t,p).target.oninput=function(){e(t,h).content=this.value,a(t,m,w).call(t)}}function b(){var t=this,n=e(t,p).el;n.classList.add("emot");var i=e(t,p).emotMaps,o=c("div","emot-packages"),r=function(r){var s=i[r],l=c("ul","emot-items");l.emotKey=r,n.appendChild(l);var d=function(n){var i=s.items[n],o=c("li","emot-item");if(l.appendChild(o),o.onclick=function(){var o=e(t,p).target.selectionStart,r=e(t,p).target.selectionEnd,c=e(t,h).content,l=c.substring(0,o),d=c.substring(r);"text"===s.type?e(t,h).content=l+i+d:e(t,h).content=l+e(t,p).before+n+e(t,p).after+d,e(t,p).target.focus(),e(t,p).target.value=e(t,h).content,e(t,p).target.selectionEnd=d?e(t,h).content.indexOf(d):e(t,h).content.length,a(t,m,w).call(t)},"text"===s.type){var r=c("span");r.title=n,r.textContent=i,o.appendChild(r)}else{var d=c("img");d.src=i,d.title=d.alt=n,o.appendChild(d)}};for(var u in s.items)d(u);var f=c("span");f.innerHTML=r,f.onclick=function(){o.childNodes.forEach((function(t){t.className=""})),f.className="emot-package-active",n.querySelectorAll(".emot-items").forEach((function(t){t.classList.remove("emot-items-active"),t.emotKey===r&&t.classList.add("emot-items-active")}))},o.appendChild(f)};for(var s in i)r(s);n.childNodes[0].classList.add("emot-items-active"),o.childNodes[0].classList.add("emot-package-active"),n.appendChild(o)}function w(){var t=e(this,p).before,n=e(this,p).after,i=e(this,h).content,a=[],o=new RegExp("\\"+t+"(.*?)\\"+n,"g");i.replace(o,(function(t,e){a.push(e)}));for(var r=0,s=a;r<s.length;r++){var c=s[r],l=e(this,d)[c];if(l){var u="<img src="+l+" alt="+c+"/>";i=i.replace(t+c+n,u)}}e(this,h).contentHTML=i}function y(){var t=c("style");t.textContent=".emot{top:30px;width:100%;margin-top:10px;border:1px solid rgba(128,128,128,0.2);border-radius:4px;background:#fff;}.emot-items{display:none;height:180px;min-height:100px;max-height:200px;resize:vertical;padding:10px;margin:0;font-size:0;overflow-x:hidden;user-select:none;}.emot-items-active{display:block;}.emot-item{list-style-type:none;padding:5px 10px;border-radius:5px;display:inline-block;font-size:12px;line-height:14px;margin:0 10px 12px 0;cursor:pointer;transition:0.3s;}.emot-item img{width:32px;height:auto;}.emot-item:hover{background:rgba(128,128,128,0.2);box-shadow:0 2px 2px 0 rgb(0 0 0 / 14%),0 3px 1px -2px rgb(0 0 0 / 20%),0 1px 5px 0 rgb(0 0 0 / 12%);}.emot-packages{padding:0;font-size:0;border-top:solid 1px rgba(128,128,128,0.2);}.emot-packages span{display:inline-block;line-height:30px;font-size:14px;padding:0 10px;cursor:pointer;}.emot-packages:nth-child(1){border-radius:0 0 0 3px;}.emot-packages span img{width:20px;position:relative;top:5px;}.emot-package-active{background:rgba(128,128,128,0.2);}",document.head.appendChild(t)}function k(t){var n=this;if(!/\.json$/.test(t))return a(this,u,x).call(this);try{fetch(t).then((function(t){return t.json()})).then((function(t){e(n,p).emotMaps=t,a(n,u,x).call(n)}))}catch(t){console.error("Emotion request failure:",JSON.stringify(t))}}return function(){function i(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),s(this,v),s(this,g),s(this,m),s(this,f),s(this,u),r(this,p,{writable:!0,value:void 0}),r(this,h,{writable:!0,value:void 0}),r(this,d,{writable:!0,value:void 0}),a(this,g,y).call(this),n(this,p,t),e(this,p).el=l(t.el),e(this,p).target=l(t.target),e(this,p).before=e(this,p).before||"[",e(this,p).after=e(this,p).after||"]",n(this,h,{content:"",contentHTML:""}),n(this,d,{}),a(this,v,k).call(this,e(this,p).emotMaps)}var o,c,x;return o=i,(c=[{key:"get",value:function(){return e(this,h)}}])&&t(o.prototype,c),x&&t(o,x),Object.defineProperty(o,"prototype",{writable:!1}),i}()}();
//# sourceMappingURL=emot.js.map
